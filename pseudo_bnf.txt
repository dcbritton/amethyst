// pseudo_bnf.txt
// contains a tentative pseudo-bnf of amethyst syntax

program     -   [var_def | func_def | type_def]*

func_def    -   def identifier ( param_list ) : type_name func_body end

param_list  -   [[parameter ,]* parameter]

parameter   -   identifier : type_name

func_body   -   [stmt]*

stmt        -   var_def
            |   logic_expr
            |   assignment
            |   conditional
            |   while_loop
            |   return_stmt

while_loop  -   while expr do comp_stmt end

conditional -   if expr comp_stmt [elsif expr comp_stmt]* [else comp_stmt] end
            
return_stmt -   return logic_expr

assignment  -   identifier op_assgn expr

var_def     -   identifier:type_name = expr

logic_expr  -   eq_expr
            |   logic_expr and eq_expr   
            |   logic_expr or eq_expr

eq_expr     -   rel_expr
            |   eq_expr == rel_expr
            |   eq_expr != rel_expr

rel_expr    -   shift_expr
            |   rel_expr < shift_expr
            |   rel_expr > shift_expr
            |   rel_expr <= shift_expr
            |   rel_expr >= shift_expr

shift_expr  -   add_expr
            |   shift_expr << add_expr
            |   shift_expr >> add_expr

add_expr    -   mult_expr
            |   add_expr + mult_expr
            |   add_expr - mult_expr  

mult_expr   -   access_expr
            |   mult_expr * access_expr
            |   mult_expr / access_expr
            |   mult_expr % access_expr

access_expr -   primary
            |   access_expr . identifier
            |   access_expr . call
            |   access_expr [ logic_expr ]

primary     -   ( expr )
            |   call
            |   literal
            |   var_name
            |   array
            |   member_name
            |   method_call

member_name -   @ identifier

method_call -   @ identifier ( expr_list )

array       -   [ expr_list ]

call        -   func_name ( expr_list )

expr_list   -   [[expr ,]* expr] 

func_name   -   identifier
var_name    -   identifier
type_name   -   identifier

type_def    -   type identifier [var_def | op_def | func_def]* end

op_def      -   op operator ( parameter ) : type_name comp_stmt end